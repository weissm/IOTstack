



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Docker stack for getting started on IOT on the Raspberry PI">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.14">
    
    
      
        <title>Grafana - IOTstack</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.d3202873.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#grafana" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="IOTstack" class="md-header-nav__button md-logo" aria-label="IOTstack">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            IOTstack
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Grafana
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
          

  

<nav class="md-tabs md-tabs--active" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." class="md-tabs__link">
        IOT Stack
      </a>
    
  </li>

      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../Adminer/" class="md-tabs__link md-tabs__link--active">
          Containers
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="IOTstack" class="md-nav__button md-logo" aria-label="IOTstack">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    IOTstack
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="IOT Stack" class="md-nav__link">
      IOT Stack
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Accessing-your-Device-from-the-internet/" title="Accessing your device from the internet" class="md-nav__link">
      Accessing your device from the internet
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Backups/" title="Backups" class="md-nav__link">
      Backups
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Custom/" title="Custom services and overriding default settings for IOTstack" class="md-nav__link">
      Custom services and overriding default settings for IOTstack
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Docker-commands/" title="Docker commands" class="md-nav__link">
      Docker commands
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Getting-Started/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Home/" title="Wiki" class="md-nav__link">
      Wiki
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../How-the-script-works/" title="How the script works" class="md-nav__link">
      How the script works
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Misc/" title="Miscellaneous" class="md-nav__link">
      Miscellaneous
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Native-RTL_433/" title="Native RTL_433" class="md-nav__link">
      Native RTL_433
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Networking/" title="Networking" class="md-nav__link">
      Networking
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../RPIEasy_native/" title="RPIEasy" class="md-nav__link">
      RPIEasy
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Understanding-Containers/" title="Let’s begin by understanding, What is Docker?" class="md-nav__link">
      Let’s begin by understanding, What is Docker?
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Updating-the-Project/" title="Updating the project" class="md-nav__link">
      Updating the project
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-15" type="checkbox" id="nav-15" checked>
    
    <label class="md-nav__link" for="nav-15">
      Containers
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Containers" data-md-level="1">
      <label class="md-nav__title" for="nav-15">
        <span class="md-nav__icon md-icon"></span>
        Containers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Adminer/" title="Adminer" class="md-nav__link">
      Adminer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Blynk_server/" title="Blynk server" class="md-nav__link">
      Blynk server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../EspruinoHub/" title="Espruinohub" class="md-nav__link">
      Espruinohub
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Grafana
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" title="Grafana" class="md-nav__link md-nav__link--active">
      Grafana
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-your-time-zone" class="md-nav__link">
    Setting your time-zone
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security" class="md-nav__link">
    Security
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Home-Assistant/" title="Home assistant" class="md-nav__link">
      Home assistant
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../InfluxDB/" title="InfluxDB" class="md-nav__link">
      InfluxDB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../MariaDB/" title="MariaDB" class="md-nav__link">
      MariaDB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Mosquitto/" title="Mosquitto" class="md-nav__link">
      Mosquitto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../MotionEye/" title="MotionQye" class="md-nav__link">
      MotionQye
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../NextCloud/" title="Next Cloud" class="md-nav__link">
      Next Cloud
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Node-RED/" title="Node-RED" class="md-nav__link">
      Node-RED
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Pi-hole/" title="Pi-hole" class="md-nav__link">
      Pi-hole
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Plex/" title="Plex" class="md-nav__link">
      Plex
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Portainer-agent/" title="Portainer agent" class="md-nav__link">
      Portainer agent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Portainer/" title="Portainer" class="md-nav__link">
      Portainer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../PostgreSQL/" title="PostgreSQL" class="md-nav__link">
      PostgreSQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python/" title="Python" class="md-nav__link">
      Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../RTL_433-docker/" title="RTL_433 Docker" class="md-nav__link">
      RTL_433 Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../TasmoAdmin/" title="TasmoAdmin" class="md-nav__link">
      TasmoAdmin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Zigbee2MQTT/" title="Zigbe2MQTT" class="md-nav__link">
      Zigbe2MQTT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deconz/" title="deCONZ" class="md-nav__link">
      deCONZ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../diyHue/" title="DIY hue" class="md-nav__link">
      DIY hue
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../openHAB/" title="Openhab" class="md-nav__link">
      Openhab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../x2go/" title="x2go" class="md-nav__link">
      x2go
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-your-time-zone" class="md-nav__link">
    Setting your time-zone
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security" class="md-nav__link">
    Security
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="grafana">Grafana</h1>
<h2 id="references">References</h2>
<ul>
<li><a href="https://hub.docker.com/r/grafana/grafana">Docker</a></li>
<li><a href="https://grafana.com/">Website</a></li>
</ul>
<h2 id="setting-your-time-zone">Setting your time-zone</h2>
<p>The default <em>~/IOTstack/services/grafana/grafana.env</em> contains this line:</p>
<pre><code>#TZ=Africa/Johannesburg
</code></pre>

<p>Uncomment that line and change the right hand side to <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">your own timezone</a>.</p>
<h2 id="security">Security</h2>
<p>If Grafana has just been installed but has <strong>never</strong> been launched then the following will be true:</p>
<ul>
<li>The folder <em>~/IOTstack/volumes/grafana</em> will not exist; and</li>
<li>
<p>The file <em>~/IOTstack/services/grafana/grafana.env</em> will contain these lines:</p>
<p>```</p>
<h1 id="gf_security_admin_useradmin">GF_SECURITY_ADMIN_USER=admin</h1>
<h1 id="gf_security_admin_passwordadmin">GF_SECURITY_ADMIN_PASSWORD=admin</h1>
<p>```</p>
</li>
</ul>
<p>You should see those lines as <strong>documentation</strong> rather than something you are being invited to edit. It is telling you that the default administative user for Grafana is "admin" and that the default password for that user is "admin".</p>
<p>If you do not change anything then, when you bring up the stack and use a browser to connect to your Raspberry Pi on port 3000, Grafana will:</p>
<ul>
<li>Expect you to login as user "admin" with password "admin"; and then</li>
<li>Force you to change the default password to something else.</li>
</ul>
<p>Thereafter, you will login as "admin" with whatever password you chose. You can change the administrator's password as often as you like via the web UI (<em>profile</em> button, <em>change password</em> tab).</p>
<p>This method (of <strong>not</strong> touching these two keys in <em>grafana.env</em>) is the recommended approach. <em>Please</em> try to resist the temptation to fiddle!</p>
<h3 id="i-want-a-different-admin-username-not-recommended">I want a different admin username (not recommended)</h3>
<p>If, before you bring up the stack for the first time, you do this:</p>
<pre><code>GF_SECURITY_ADMIN_USER=jack
#GF_SECURITY_ADMIN_PASSWORD=admin
</code></pre>

<p>then, when you bring up the stack and connect on port 3000, Grafana will:</p>
<ul>
<li>Expect you to login as user "jack" with password "admin"; and then</li>
<li>Force you to change the default password to something else.</li>
</ul>
<p>Thereafter, "jack" will be the Grafana administrator and you will login with the password you chose, until you decide to change the password to something else via the web UI.</p>
<p>Don't think you can come back later and tweak the Grafana administrator name in the environment variables. It doesn't work that way. It's a one-shot.</p>
<h3 id="i-want-a-different-default-admin-password-not-recommended">I want a different default admin password (not recommended)</h3>
<p>Well, first off, the two methods above both make you set a different password on first login so there probably isn't much point to this.</p>
<p>But, if you <em>really</em> insist…</p>
<p>If, before you bring up the stack for the first time, you do this:</p>
<pre><code>#GF_SECURITY_ADMIN_USER=admin
GF_SECURITY_ADMIN_PASSWORD=jack
</code></pre>

<p>then, when you bring up the stack and use a browser to connect to your Raspberry Pi on port 3000, Grafana will expect you to login as user "admin" with password "jack".</p>
<p>Grafana will not force you to change the password on first login but you will still be able to change it via the web UI.</p>
<p>But don't think you can come back later and change the password in the environment variables. It doesn't work that way. It's a one-shot.</p>
<h3 id="i-want-to-change-everything-not-recommended">I want to change everything (not recommended)</h3>
<p>If, before you bring up the stack for the first time, you do this:</p>
<pre><code>GF_SECURITY_ADMIN_USER=bill
GF_SECURITY_ADMIN_PASSWORD=jack
</code></pre>

<p>then, when you bring up the stack and use a browser to connect to your Raspberry Pi on port 3000, Grafana will expect you to login as user "bill" with password "jack".</p>
<p>Grafana will not force you to change the password on first login but you will still be able to change it via the web UI.</p>
<p>But don't think you can come back later and tweak either the username or password in the environment variables. It doesn't work that way. It's a one-shot.</p>
<h3 id="distilling-it-down">Distilling it down</h3>
<p><strong>Before</strong> Grafana is launched for the first time:</p>
<ul>
<li><em>GF_SECURITY_ADMIN_USER</em> has a default value of "admin". You <em>can</em> explicitly set it to "admin" or some other value. Whatever option you choose then that's the account name of Grafana's administrative user. But choosing any value other than "admin" is probably a bad idea.</li>
<li><em>GF_SECURITY_ADMIN_PASSWORD</em> has a default value of "admin". You can explicitly set it to "admin" or some other value. If its value is "admin" then you will be forced to change it the first time you login to Grafana. If its value is something other than "admin" then that will be the password until you change it via the web UI.</li>
</ul>
<p>These two environment keys <strong>only</strong> work for the <strong>first</strong> launch of Grafana. Once Grafana has been launched, you can <strong>never</strong> change either the username or the password by editing <em>grafana.env</em>.</p>
<p>For this reason, it is better to leave <em>grafana.env</em> in its shrink-wrapped state. Your first login is as "admin/admin" and then you set the password you actually want when Grafana prompts you to change it.</p>
<h3 id="help-i-forgot-my-grafana-admin-password">HELP – I forgot my Grafana admin password!</h3>
<p>Assuming your IOTstack is up, the magic incantation is:</p>
<pre><code>$ docker exec grafana grafana-cli --homepath &quot;/usr/share/grafana&quot; admin reset-admin-password &quot;admin&quot;
</code></pre>

<p>Then, use a browser to connect to your Raspberry Pi on port 3000. Grafana will:</p>
<ul>
<li>Expect you login as user "admin" with password "admin"; and then</li>
<li>Force you to change the default password to something else.</li>
</ul>
<p>This magic incantation assumes that your administrative username is "admin". If you ignored the advice above and changed the administator username to something else then all bets are off. It might work anyway but we haven't tested it. Sorry. But that's why we said changing the username was not recommended.</p>
<h2 id="overriding-grafana-settings">Overriding Grafana settings</h2>
<p>Grafana documentation contains <a href="https://grafana.com/docs/installation/configuration/">a list of settings</a>. Settings are described in terms of how they appear in ".ini" files.</p>
<p>An example of the sort of thing you might want to do is to enable anonymous access to your Grafana dashboards. The <a href="https://grafana.com/docs/grafana/latest/auth/overview/#anonymous-authentication">Grafana documentation</a> describes this in ".ini" format as:</p>
<pre><code>[auth.anonymous]
enabled = true

# Organization name that should be used for unauthenticated users
org_name = Main Org.

# Role for unauthenticated users, other valid values are `Editor` and `Admin`
org_role = Viewer
</code></pre>

<p>".ini" format is not really appropriate in a Docker context. Instead, you use environment variables to override Docker's settings. Environment variables are placed in <em>~/IOTstack/services/grafana/grafana.env</em>.</p>
<p>You need to convert ".ini" format to environment variable syntax. The rules are:</p>
<ul>
<li>Start with "GF_", then</li>
<li>Append the [section name], replacing any periods with underscores, then</li>
<li>Append the section key "as is", then</li>
<li>Append an "=", then</li>
<li>Append the right hand side in quotes.</li>
</ul>
<p>Applying those rules gets you:</p>
<pre><code>GF_AUTH_ANONYMOUS_ENABLED=&quot;true&quot;
GF_AUTH_ANONYMOUS_ORG_NAME=&quot;Main Org.&quot;
GF_AUTH_ANONYMOUS_ORG_ROLE=&quot;Viewer&quot;
</code></pre>

<blockquote>
<p>It is not strictly necessary to encapsulate every right hand side value in quotes. In the above, both "true" and "Viewer" would work without quotes, whereas "Main Org." needs quotes because of the embedded space.</p>
</blockquote>
<p>After you have changed <em>~/IOTstack/services/grafana/grafana.env</em>, you need to propagate the changes into the Grafana container:</p>
<pre><code>$ cd ~/IOTstack
$ docker-compose stop grafana
$ docker-compose up -d
</code></pre>

<blockquote>
<p>In theory, the second command could be omitted, or both the second and third commands could be replaced with "docker-compose restart grafana" but experience suggests stopping the container is more reliable.</p>
</blockquote>
<p>A slightly more real-world example would involve choosing a different default organisation name for anonymous access. This example uses "ChezMoi".</p>
<p>First, the environment key needs to be set to that value:</p>
<pre><code>GF_AUTH_ANONYMOUS_ORG_NAME=ChezMoi
</code></pre>

<p>Then that change needs to be propagated into the Grafana container as explained above.</p>
<p>Next, Grafana needs to be told that "ChezMoi" is the default organisation:</p>
<ol>
<li>Use your browser to login to Grafana as an administrator.</li>
<li>From the "Server Admin" slide-out menu on the left hand side, choose "Orgs".</li>
<li>In the list that appears, click on "Main Org". This opens an editing panel.</li>
<li>Change the "Name" field to "ChezMoi" and click "Update".</li>
<li>
<p>Sign-out of Grafana. You will be taken back to the login screen. Your URL bar will look something like this:</p>
<p><code>http://myhost.mydomain.com:3000/login</code>
6. Edit the URL to remove the "login" suffix and press return. If all your changes were applied successfully, you will have anonymous access and the URL will look something like this:</p>
<p><code>http://myhost.mydomain.com:3000/?orgId=1</code></p>
</li>
</ol>
<h2 id="help-i-made-a-mess">HELP – I made a mess!</h2>
<p>"I made a bit of a mess with Grafana. First time user. Steep learning curve. False starts, many. Mistakes, unavoidable. Been there, done that. But now I <strong>really</strong> need to start from a clean slate. And, yes, I understand there is no <em>undo</em> for this."</p>
<p>Begin by stopping Grafana:</p>
<pre><code>$ cd ~/IOTstack
$ docker-compose stop grafana
</code></pre>

<p>You have two options:</p>
<ol>
<li>
<p>Destroy your settings and dashboards but retain any plugins you may have installed:</p>
<p><code>$ sudo rm ~/IOTstack/volumes/grafana/data/grafana.db</code></p>
</li>
<li>
<p>Nuke everything (triple-check this command <strong>before</strong> you hit return):</p>
<p><code>$ sudo rm -rf ~/IOTstack/volumes/grafana/data</code></p>
</li>
</ol>
<p>This is where you should edit <em>~/IOTstack/services/grafana/grafana.env</em> to correct any problems (such as choosing an administrative username other than "admin").</p>
<p>When you are ready, bring Grafana back up again:</p>
<pre><code>$ cd ~/IOTstack
$ docker-compose up -d
</code></pre>

<p>Grafana will automatically recreate everything it needs. You will be able to login as "admin/admin".</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../EspruinoHub/" title="Espruinohub" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Espruinohub
              </div>
            </div>
          </a>
        
        
          <a href="../Home-Assistant/" title="Home assistant" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Home assistant
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.2d1db4bd.min.js"></script>
      <script src="../../assets/javascripts/bundle.6627ddf3.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ['tabs'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>